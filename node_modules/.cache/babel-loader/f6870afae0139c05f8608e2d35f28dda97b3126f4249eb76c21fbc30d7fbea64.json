{"ast":null,"code":"var _jsxFileName = \"/Users/deepprabhu/Documents/java/ITIS/Assignment_3/frontend/src/components/Welcome/Welcome.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport welcomestyle from \"./Welcome.module.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Welcome = ({\n  userState,\n  setUserState\n}) => {\n  _s();\n  const [books, setBooks] = useState([]);\n  const navigate = useNavigate();\n  const logout = () => {\n    setUserState({});\n    localStorage.removeItem(\"token\");\n    navigate(\"/login\", {\n      replace: true\n    });\n  };\n  const fetchBooks = async () => {\n    try {\n      const response = await axios.get(\"http://ec2-3-107-93-162.ap-southeast-2.compute.amazonaws.com:5000/books\", {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n        }\n      });\n      setBooks(response.data);\n    } catch (error) {\n      console.error(\"Error fetching books:\", error);\n    }\n  };\n  const downloadBook = fileUrl => {\n    const link = document.createElement('a');\n    link.href = fileUrl;\n    link.download = fileUrl.split('/').pop();\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n  useEffect(() => {\n    fetchBooks();\n  }, []);\n  const addBook = async bookData => {\n    try {\n      const formData = new FormData();\n      formData.append('title', bookData.title);\n      formData.append('author', bookData.author);\n      formData.append('file', bookData.file);\n      const response = await axios.post(\"http://ec2-3-107-93-162.ap-southeast-2.compute.amazonaws.com:5000/add-book\", formData, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n          'Content-Type': 'multipart/form-data'\n        }\n      });\n      alert(response.data.message);\n      fetchBooks(); // Refresh book list after adding a new book\n    } catch (error) {\n      console.error(\"Error adding book:\", error);\n      alert(\"Error adding book. Please try again.\");\n    }\n  };\n  const handleAddBook = e => {\n    e.preventDefault();\n    const bookData = {\n      title: e.target.title.value,\n      author: e.target.author.value,\n      file: e.target.file.files[0]\n    };\n    addBook(bookData);\n  };\n  if (!userState) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: welcomestyle.welcome,\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: [\"Welcome, \", userState.fname]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: logout,\n      children: \"Logout\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), userState.is_admin && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Add Book\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleAddBook,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"title\",\n          placeholder: \"Title\",\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"author\",\n          placeholder: \"Author\",\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          name: \"file\",\n          accept: \".pdf\",\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          children: \"Add Book\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Books\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: books.map(book => /*#__PURE__*/_jsxDEV(\"li\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [book.title, \" by \", book.author]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => downloadBook(book.file_url),\n          children: \"Download\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 13\n        }, this)]\n      }, book.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n};\n_s(Welcome, \"MwDtCv3/1QDi+XMz646ujaLPGkg=\", false, function () {\n  return [useNavigate];\n});\n_c = Welcome;\nexport default Welcome;\nvar _c;\n$RefreshReg$(_c, \"Welcome\");","map":{"version":3,"names":["React","useEffect","useState","useNavigate","axios","welcomestyle","jsxDEV","_jsxDEV","Welcome","userState","setUserState","_s","books","setBooks","navigate","logout","localStorage","removeItem","replace","fetchBooks","response","get","headers","Authorization","getItem","data","error","console","downloadBook","fileUrl","link","document","createElement","href","download","split","pop","body","appendChild","click","removeChild","addBook","bookData","formData","FormData","append","title","author","file","post","alert","message","handleAddBook","e","preventDefault","target","value","files","children","fileName","_jsxFileName","lineNumber","columnNumber","className","welcome","fname","onClick","is_admin","onSubmit","type","name","placeholder","required","accept","map","book","file_url","id","_c","$RefreshReg$"],"sources":["/Users/deepprabhu/Documents/java/ITIS/Assignment_3/frontend/src/components/Welcome/Welcome.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport welcomestyle from \"./Welcome.module.css\";\n\nconst Welcome = ({ userState, setUserState }) => {\n  const [books, setBooks] = useState([]);\n  const navigate = useNavigate();\n\n  const logout = () => {\n    setUserState({});\n    localStorage.removeItem(\"token\");\n    navigate(\"/login\", { replace: true });\n  };\n\n  const fetchBooks = async () => {\n    try {\n      const response = await axios.get(\"http://ec2-3-107-93-162.ap-southeast-2.compute.amazonaws.com:5000/books\", {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n        }\n      });\n      setBooks(response.data);\n    } catch (error) {\n      console.error(\"Error fetching books:\", error);\n    }\n  };\n\n  const downloadBook = (fileUrl) => {\n    const link = document.createElement('a');\n    link.href = fileUrl;\n    link.download = fileUrl.split('/').pop();\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  useEffect(() => {\n    fetchBooks();\n  }, []);\n\n  const addBook = async (bookData) => {\n    try {\n      const formData = new FormData();\n      formData.append('title', bookData.title);\n      formData.append('author', bookData.author);\n      formData.append('file', bookData.file);\n\n      const response = await axios.post(\"http://ec2-3-107-93-162.ap-southeast-2.compute.amazonaws.com:5000/add-book\", formData, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n          'Content-Type': 'multipart/form-data'\n        }\n      });\n      alert(response.data.message);\n      fetchBooks(); // Refresh book list after adding a new book\n    } catch (error) {\n      console.error(\"Error adding book:\", error);\n      alert(\"Error adding book. Please try again.\");\n    }\n  };\n\n  const handleAddBook = (e) => {\n    e.preventDefault();\n    const bookData = {\n      title: e.target.title.value,\n      author: e.target.author.value,\n      file: e.target.file.files[0]\n    };\n    addBook(bookData);\n  };\n\n  if (!userState) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <div className={welcomestyle.welcome}>\n      <h1>Welcome, {userState.fname}</h1>\n      <button onClick={logout}>Logout</button>\n\n      {userState.is_admin && (\n        <div>\n          <h2>Add Book</h2>\n          <form onSubmit={handleAddBook}>\n            <input type=\"text\" name=\"title\" placeholder=\"Title\" required />\n            <input type=\"text\" name=\"author\" placeholder=\"Author\" required />\n            <input type=\"file\" name=\"file\" accept=\".pdf\" required />\n            <button type=\"submit\">Add Book</button>\n          </form>\n        </div>\n      )}\n\n      <h2>Books</h2>\n      <ul>\n        {books.map(book => (\n          <li key={book.id}>\n            <p>{book.title} by {book.author}</p>\n            <button onClick={() => downloadBook(book.file_url)}>Download</button>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n\nexport default Welcome;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}